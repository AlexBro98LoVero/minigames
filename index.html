<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flashcards — Gioco</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#1E90FF; --glass: rgba(255,255,255,0.04);
      --muted: #9aa6bd; --white: #e6eef8;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg) 0%, #071023 100%);color:var(--white);font-size:18px}
    .app{display:grid;grid-template-columns:260px 1fr;gap:24px;min-height:100vh;padding:28px}
    .sidebar{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    .logo{font-weight:700;color:var(--accent);font-size:20px;margin-bottom:12px}
    details{margin-bottom:10px}
    details summary{cursor:pointer;color:var(--muted);font-size:15px;list-style:none}
    details[open] summary{color:var(--white);}
    .chapters{display:flex;flex-direction:column;gap:6px;margin-top:6px}
    .btn{background:transparent;border:0;padding:10px 12px;border-radius:10px;color:var(--white);cursor:pointer;text-align:left;font-size:16px}
    .btn:hover{background:var(--glass)}
    .btn.active{background:linear-gradient(90deg, rgba(30,144,255,0.12), rgba(30,144,255,0.06));box-shadow:0 4px 14px rgba(30,144,255,0.08);}
    .main{padding:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;position:relative}
    .topbar{margin-bottom:16px}
    .title{font-size:24px;font-weight:700}
    .sub{color:var(--muted);font-size:16px}
    .card-wrap{perspective:1200px;margin-bottom:16px;display:flex;justify-content:center}
    .card{width:340px;height:280px;border-radius:14px;position:relative;transform-style:preserve-3d;transition:transform .6s;cursor:pointer;margin:auto}
    .card.flipped{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;border-radius:14px;backface-visibility:hidden;display:flex;align-items:center;justify-content:center;padding:20px;box-shadow:0 8px 24px rgba(2,6,23,0.6);font-size:18px}
    .front{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
    .back{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);transform:rotateY(180deg)}
    .question{font-size:18px;text-align:center}
    .image-q img{max-width:100%;max-height:100%;object-fit:contain;border-radius:10px}
    .answer{font-size:17px;text-align:center;color:var(--muted)}
    #nextBtn{margin-top:16px;padding:12px 20px;background:var(--accent);border:none;border-radius:10px;color:white;cursor:pointer;font-weight:600;font-size:16px}
    #nextBtn:hover{opacity:0.9}
    .hidden{display:none !important}
    @media(max-width:820px){.app{grid-template-columns:1fr;padding:16px}.sidebar{order:2}}
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar" id="sidebar">
      <div class="logo">Flashcards — Gioco</div>
      <div id="subjects"></div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="title" id="mainTitle">Seleziona una materia</div>
        <div class="sub" id="mainSub">Scegli un capitolo o prova tutte le domande di una materia.</div>
      </div>
      <section id="cardSection"></section>
      <button id="nextBtn" class="hidden">Successiva</button>
    </main>
  </div>

  <script>
    const DATA=[
      {id:'matematica',title:'Matematica',chapters:[
        {id:'algebra',title:'Algebra',cards:[
          {q:"Cos'è un polinomio?",a:"Un'espressione algebrica formata da monomi sommati.",type:'text'},
          {q:'/images/triangle.png',a:'Figura: triangolo (se fosse un immagine reale).',type:'image'}]},
        {id:'analisi',title:'Analisi',cards:[
          {q:'Enuncia il Teorema Fondamentale del Calcolo',a:'Se f è continua su [a,b], allora... (riassunto).',type:'text'}]}]},
      {id:'storia',title:'Storia',chapters:[
        {id:'medioevo',title:'Medioevo',cards:[
          {q:'Quando finisce il Medioevo?',a:'Tradizionalmente si prende il 1492 o il 1453 come date di confine.',type:'text'}]}]}];

    let currentSubject=null,currentChapter=null,currentCards=[],currentIndex=0;
    const subjectsEl=document.getElementById('subjects');
    const mainTitle=document.getElementById('mainTitle');
    const mainSub=document.getElementById('mainSub');
    const cardSection=document.getElementById('cardSection');
    const nextBtn=document.getElementById('nextBtn');

    function createSidebar(){
      subjectsEl.innerHTML='';
      DATA.forEach(sub=>{
        const details=document.createElement('details');
        const summary=document.createElement('summary');
        summary.textContent=sub.title;
        details.appendChild(summary);
        const chapters=document.createElement('div');chapters.className='chapters';
        const allBtn=document.createElement('button');allBtn.className='btn';allBtn.textContent='Tutte le domande';
        allBtn.onclick=()=>selectSubject(sub.id,null,allBtn);
        chapters.appendChild(allBtn);
        sub.chapters.forEach(ch=>{
          const b=document.createElement('button');b.className='btn';b.textContent=ch.title;
          b.onclick=()=>selectSubject(sub.id,ch.id,b);
          chapters.appendChild(b);
        });
        details.appendChild(chapters);
        subjectsEl.appendChild(details);
      });
    }

    function selectSubject(subId,chapId,btnEl){
      document.querySelectorAll('.btn').forEach(b=>b.classList.remove('active'));
      if(btnEl) btnEl.classList.add('active');
      currentSubject=DATA.find(s=>s.id===subId);
      currentChapter=currentSubject&&chapId?currentSubject.chapters.find(c=>c.id===chapId):null;
      mainTitle.textContent=currentSubject?currentSubject.title:'Seleziona una materia';
      mainSub.textContent=currentChapter?currentChapter.title:(currentSubject?'Tutte le domande della materia':'Scegli un capitolo.');
      if(!currentSubject){currentCards=[];renderCard();return}
      if(currentChapter){currentCards=[...currentChapter.cards]}else{currentCards=currentSubject.chapters.flatMap(ch=>ch.cards)}
      shuffleArray(currentCards);
      currentIndex=0;
      nextBtn.classList.remove('hidden');
      renderCard();
    }

    function renderCard(){
      cardSection.innerHTML='';
      if(currentCards.length===0){cardSection.innerHTML='<div style="color:var(--muted);">Nessuna carta disponibile.</div>';return}
      if(currentIndex>=currentCards.length){cardSection.innerHTML='<div style="color:var(--muted);">Hai finito le carte!</div>';nextBtn.classList.add('hidden');return}
      const cardData=currentCards[currentIndex];
      const wrap=document.createElement('div');wrap.className='card-wrap';
      const c=document.createElement('div');c.className='card';
      c.onclick=()=>c.classList.toggle('flipped');
      const front=document.createElement('div');front.className='face front';
      if(cardData.type==='image'){
        const imgWrap=document.createElement('div');imgWrap.className='image-q';
        const img=document.createElement('img');img.src=cardData.q;img.alt='Domanda immagine';
        imgWrap.appendChild(img);front.appendChild(imgWrap);
      }else{
        const p=document.createElement('div');p.className='question';p.textContent=cardData.q;front.appendChild(p);
      }
      const back=document.createElement('div');back.className='face back';
      const a=document.createElement('div');a.className='answer';a.textContent=cardData.a;back.appendChild(a);
      c.appendChild(front);c.appendChild(back);wrap.appendChild(c);
      cardSection.appendChild(wrap);
    }

    nextBtn.addEventListener('click',()=>{currentIndex++;renderCard();});

    function shuffleArray(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

    createSidebar();
    renderCard();
  </script>
</body>
</html>
